# QianQianCaterSystem


## 项目建立之初
===========================================
1. 把邮件工具类中的邮箱地址和授权码抽取成配置文件，这样可以保护私密信息不在代码里，
	也更合理，不用再修改代码。在git中设置了忽略此配置文件。
	
2. 通过异步方式加载页头页脚会出现页面打开闪烁的现象

	客户端页面的浏览体验一定要好，所以动态页面应该更好一些，通过`jsp`的`include`标签插入页面上不变的部分
	
	换成动态页面后体验提升了一个档次，页面加载流畅丝滑。  
	jsp 上引入其他文件，成文当前文档的一部分有两种方式：  
	```
	<%@include file=""%> 指令
	<jsp:inclde page=" "><jsp:include> 标签
	```
	前者是相当于直接导入那一段文本后编译成jspservlet  
	后者则是分别编译。  
	实际使用上暂时没有发现区别。

* 前端框架bootstrap3
	
	感觉可以使用的东西不多，而且十分不灵活，也许是没有学过Less的原因，没有对底层有深刻的认识，
	使用上束手束脚，不能随意地在已定的框子里添加自己的东西，应该是列都是浮动实现的，
	所以加入自己的东西，如果没有可以套用的css，几乎就是分离的，格格不入的。
	自己定义的样式不敢多加，自己写的宽高边距没有任何响应式，在窗口变化的时候几乎就是灾难。
	
	bootstrap框架整体比较圆润，与国内的网站风格有一些出入。

* 数据源

	试着使用druid数据源，相比c3p0要简单一些，阿里巴巴出品是当前最好的数据源。
	
* DAO工具

	在用户模块使用spring框架内置的Template工具，因为构建核心对象Template的时候直接传入了数据源，
	没有连接对象所以不能实现事务操作，当然这是没有采用spring框架的情况。
	该对象的方法的特点是要求返回的结果比较严格，期望是一个结果，就不能是两个，
	这一点在DbUtils上比较宽松，如果多个结果就封装第一条返回。
	
	计划在菜品和订单这些操作上用DbUtils，都尽量练习一下。

### 1.Ajax 异步请求验证的问题
在提交时发送异步请求提交数据，这是正常且合理的，在发送ajax之前需要检查各项输入是否符合要求，
这也是合理的，注册时，用户名要求唯一，所以需要发送异步请求询问后端，
但是这个验证用户名的请求还	没有返回时，可能就已经提交数据，或者前端验证不通过，
因为请求是异步的，所以无论用户名正确与否都无法阻止提交动作和提交请求。

**结论：**异步请求中不能包含异步请求，这会导致互相无法配合，就像它们的名字一样，始终无法同步。

**解决：**  
方式一： 在用户名输入框失去焦点或者内容改变时，发送异步请求，
将检查结果以`input`标签属性的方式记录下来，提交的时候检查标记即可。   
方式二： 在前一个ajax请求的回调函数里调用第二个ajax请求就没问题了。这样保证他们顺序执行。
	
### 2.jsp中EL表达式失效问题  
在jsp中使用EL表达式失效，原因是web.xml文件的版本问题。  
**解决：**将web.xml文件换成高版本。主要是替换dtd部分。

### 3.菜品表和菜品实体设计问题
没有数量单位的列，对于菜品的多少是一个单位不明确。而且卖的东西不一定是菜品，所以实体的把握不太准确。实际上还可以买饮料酒水。


## 2019-12-12
=================================================
项目的进度异常缓慢，本来期望套用前端UI库layui 但是layui 对页面的修改过于强大，动用了很多js导致要使用其组件必须要套用其规定的接口数据格式等，  
看着就头大，不熟悉js底层语法，不善于阅读文档，接口也不规范，感觉不理解作者的思路难以下手，我倒是希望这个UI库简单一些，只做一些界面上的优化美观，  
实际上对我来说前端的框架总是给我一种束手束脚的感觉，但是自己写UI感觉就更差了，没有熟练的掌握CSS，没有学过CSS3 ，媒体查询不懂，  
还非要搞成响应式页面。  

本来想着做一个稍大规模的工程，结果不管是从一开始的构思，还是到后面的实现，都是感觉异常艰难，实际上根本就不熟练，强行胸有成竹是不现实的。  
今天删除了数据库里的图片表，减小复杂度，先做简单的流程应该会好一些。

刚开始想的是顾客端用servlet 不使用框架，然后静态页面，使用json数据交流，  
商家的一端使用 spring + springMVC + MyBatis 实现，后来发现图片的问题很难处理，  
就想到单独做一个响应图片的 servlet ，然后鉴于比较复杂就放弃了，  
随后发现不管是商品还是用户，为了避免重复编码，几乎都是需要同一套service 和 Dao ，  
但是做着做着新的问题又出现了，能给顾客看的东西和后台需要管理的实体虽然是一样的，但是有些属性顾客部分用不到，  
封装起来麻烦，而且浪费数据带宽，解析费劲。

数据库里的实体和java类实体有差异，导致查询和封装会出一些令人头疼的问题，  
数据库里面一对多的关系，在多的一方建立外键指向一的一方，  
java实体类正好相反，一对多的关系，在一的一方建立多的一方的引用，这时候通常是另一个类或者是一个列表List 或者数组，  
矛盾的点就在于 用自动化工具封装实体的对象的时候不好给里面的类或者列表赋值，因为这又要查询另一张表才能做到，  
在Dao里面调用另一个Dao是一种方法，但是总觉得两个Dao就耦合，损失了Dao的原子性，  
在Service里面填充数据就和主要业务逻辑搞到一起去了，很难让人集中精力写业务逻辑。

还有很烦躁的一点就是，我太摇摆不定了，没有统一的命名规则，觉得这样不好，觉得那样不好总是很难选择摇摆不定，  
导致数据库里面的表名现在有三种风格，为什么要给表名加上前缀，有无必要，为什么不一加到底。

真正的实体类里面数据项太多，而真正数据传递的时候用不到，该怎么办呢？重新写一个与实体差不多的类，该怎么命名呢？

总是想着能不能快一点做完，再学一些新的东西，实际上每天只能写一点点东西，进度实在捉急，没有学会，很烦。

